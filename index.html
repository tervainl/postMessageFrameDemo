<!DOCTYPE html>
<html>
  <head>
    <title>postMessage-test</title>
    <meta charset="UTF-8" />
  </head>

  <body>
    <h1>操作介面</h1>
    <label for="message">輸入訊息：</label>
    <input
      type="text"
      id="message"
      placeholder="輸入要傳送的訊息"
      value="操作介面回傳訊息"
    />
    <button id="sendMessage">傳送訊息</button>

    <script>
      let messageSent = false; // 是否已發送

      document
        .getElementById("sendMessage")
        .addEventListener("click", function () {
          const message = document.getElementById("message").value;
          if (window.parent !== window) {
            console.log(window.parent);
            window.parent.postMessage(message, "*");
            messageSent = true; // 訊息已發送，設置標誌
            alert("訊息已傳送：" + message);
          } else {
            alert("此頁未嵌入 iframe，無法傳送訊息。");
          }
          window.close();
        });
    </script>
  </body>
</html>
